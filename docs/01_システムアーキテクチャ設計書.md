# システムアーキテクチャ設計書

## 1. システム概要

REST APIテストアプリケーションは、様々なREST APIエンドポイントに対してHTTPリクエストを送信し、レスポンスを確認できるWebアプリケーションです。本システムは3つの異なる技術スタックで実装されています。

## 2. システム構成

### 2.1 実装バリエーション

| 実装 | 技術スタック | 動作環境 | ポート |
|------|------------|---------|--------|
| Google Apps Script版 | Google Apps Script, HTML, CSS, JavaScript | Google Cloud | - |
| Flutter版 | Flutter (Dart), HTTP Package | Web Browser (Chrome) | 8080 |
| Spring Boot版 | Spring Boot 3.2, Gradle, Thymeleaf, WebClient | JVM | 8081 |

### 2.2 共通アーキテクチャ

```
┌─────────────────────────────────────┐
│         ユーザーインターフェース          │
│  (HTML/CSS/JavaScript or Flutter)   │
└─────────────────┬───────────────────┘
                  │
                  ▼
┌─────────────────────────────────────┐
│         アプリケーション層              │
│   (リクエスト処理・レスポンス整形)        │
└─────────────────┬───────────────────┘
                  │
                  ▼
┌─────────────────────────────────────┐
│          HTTPクライアント層            │
│    (外部APIへのリクエスト送信)          │
└─────────────────┬───────────────────┘
                  │
                  ▼
┌─────────────────────────────────────┐
│           外部REST API               │
│        (テスト対象のAPI)              │
└─────────────────────────────────────┘
```

## 3. 各実装の詳細アーキテクチャ

### 3.1 Google Apps Script版

```
Google Drive / Google Cloud Platform
├── Code.gs (サーバーサイド処理)
│   ├── doGet() - HTMLページの配信
│   ├── include() - HTMLパーツの結合
│   └── makeAPIRequest() - API呼び出し処理
├── index.html (UIテンプレート)
└── styles.html (スタイルシート)
```

**特徴:**
- サーバーレスアーキテクチャ
- Google認証による自動セキュリティ
- 無料枠での運用可能

### 3.2 Flutter版

```
Flutter Web Application
├── lib/
│   ├── main.dart (エントリーポイント)
│   ├── screens/
│   │   └── api_test_screen.dart (UI実装)
│   └── services/
│       └── api_service.dart (HTTPクライアント)
└── web/ (Web配信用リソース)
```

**特徴:**
- シングルページアプリケーション
- リアクティブUI
- クロスプラットフォーム対応可能

### 3.3 Spring Boot版

```
Spring Boot Application
├── RestApiTesterApplication.java (起動クラス)
├── controller/
│   ├── HomeController.java (画面制御)
│   └── ApiTestController.java (API制御)
├── service/
│   └── ApiTestService.java (ビジネスロジック)
├── templates/
│   └── index.html (Thymeleafテンプレート)
└── static/
    ├── css/style.css
    └── js/app.js
```

**特徴:**
- MVC (Model-View-Controller) パターン
- 非同期処理 (WebClient)
- エンタープライズグレード

## 4. データフロー

### 4.1 リクエスト処理フロー

1. **ユーザー入力**
   - エンドポイントURL
   - HTTPメソッド選択
   - パラメータ設定（Key-Value）

2. **リクエスト構築**
   - GETメソッド: クエリストリング生成
   - その他メソッド: JSONボディ生成

3. **API呼び出し**
   - HTTPヘッダー設定
   - タイムアウト処理
   - エラーハンドリング

4. **レスポンス処理**
   - ステータスコード取得
   - ヘッダー情報取得
   - ボディ整形（JSON Pretty Print）

5. **結果表示**
   - UI更新
   - エラー表示

## 5. セキュリティ考慮事項

### 5.1 CORS (Cross-Origin Resource Sharing)
- ブラウザのセキュリティポリシーによる制限
- サーバーサイドプロキシによる回避

### 5.2 認証・認可
- Google Apps Script: Google認証
- Flutter/Spring Boot: 必要に応じて実装

### 5.3 入力検証
- URLフォーマット検証
- パラメータのサニタイズ

## 6. パフォーマンス考慮事項

### 6.1 非同期処理
- UIのブロッキング防止
- タイムアウト設定

### 6.2 リソース管理
- メモリ使用量の最適化
- 大容量レスポンスの処理

## 7. 拡張性

### 7.1 機能拡張の可能性
- 認証機能の追加（OAuth, API Key等）
- リクエスト履歴の保存
- レスポンスの比較機能
- 自動テストの実装
- WebSocket対応

### 7.2 技術的拡張性
- マイクロサービス化
- コンテナ化（Docker）
- CI/CDパイプライン構築